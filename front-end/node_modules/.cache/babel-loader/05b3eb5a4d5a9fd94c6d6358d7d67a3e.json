{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\multicampus\\\\Desktop\\\\projects\\\\theground\\\\front-end\\\\src\\\\landing\\\\components\\\\NaverLoginHandler.js\",\n    _s = $RefreshSig$();\n\nimport { useEffect } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst NaverLoginHandler = () => {\n  _s();\n\n  const navigate = useNavigate();\n  const CLIENT_ID = \"PVGrBZM8vqHq_92Vh6Wx\";\n  const CLIENT_SECRET = \"tSbysXbRL1\";\n  const MAIN_URI = \"https://j7d109.p.ssafy.io\"; // const MAIN_URI = \"http://localhost:3000\";\n\n  const REDIRECT_URI = MAIN_URI + \"/naverLogin\";\n  const CORS_URI = \"https://cors-anywhere.herokuapp.com/\"; // 인가코드\n\n  const location = useLocation();\n  const CODE = location.search.split('=')[1];\n  const STATE = location.search.split('=')[2]; // 네이버로 토큰 발급 요청\n\n  const getNaverToken = () => {\n    axios.post(`https://nid.naver.com/oauth2.0/token?grant_type=authorization_code&client_id=${CLIENT_ID}&client_secret=${CLIENT_SECRET}&code=${CODE}&state=${STATE}`, {\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded;charset=utf-8\"\n      }\n    }, {\n      responseType: \"json\"\n    }).then(res => res.data).then(data => {\n      if (data.access_token) {\n        axios.post(\"https://j7d109.p.ssafy.io/back/users/login\", {\n          accessToken: data.access_token,\n          loginType: \"N\"\n        }, {\n          headers: {\n            \"Content-type\": \"application/json\",\n            Accept: \"application/json\"\n          }\n        }).then(res => {\n          console.log(res);\n\n          if (res.data.message === \"회원가입을 먼저 해주세요.\") {\n            // 전역 스테이트로 메인에서 화면이 모달이 뜨게 하기\n            navigate(\"/signupModal\");\n          } else {\n            navigate(\"/main\");\n          }\n        });\n      } else {\n        navigate(\"/\");\n      }\n    });\n  }; // 취소시 로직\n\n\n  let error = new URL(window.location.href).searchParams.get(\"error_description\");\n  useEffect(() => {\n    if (!CODE) return;\n    getNaverToken();\n\n    if (error === 'Canceled By User') {\n      navigate(\"/\");\n    }\n\n    ;\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"p\", {\n    style: {\n      color: 'green'\n    },\n    children: \"\\uB124\\uC774\\uBC84 \\uB85C\\uADF8\\uC778 \\uC911\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 10\n  }, this);\n};\n\n_s(NaverLoginHandler, \"gMsdikdDs1f1NUVrv3Ag60oK04k=\", false, function () {\n  return [useNavigate, useLocation];\n});\n\n_c = NaverLoginHandler;\nexport default NaverLoginHandler;\n\nvar _c;\n\n$RefreshReg$(_c, \"NaverLoginHandler\");","map":{"version":3,"names":["useEffect","useLocation","useNavigate","axios","NaverLoginHandler","navigate","CLIENT_ID","CLIENT_SECRET","MAIN_URI","REDIRECT_URI","CORS_URI","location","CODE","search","split","STATE","getNaverToken","post","headers","responseType","then","res","data","access_token","accessToken","loginType","Accept","console","log","message","error","URL","window","href","searchParams","get","color"],"sources":["C:/Users/multicampus/Desktop/projects/theground/front-end/src/landing/components/NaverLoginHandler.js"],"sourcesContent":["import { useEffect } from \"react\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\n\r\n\r\nconst NaverLoginHandler = () => {\r\n\r\n  const navigate = useNavigate();\r\n  const CLIENT_ID = \"PVGrBZM8vqHq_92Vh6Wx\";\r\n  const CLIENT_SECRET = \"tSbysXbRL1\";\r\n  const MAIN_URI = \"https://j7d109.p.ssafy.io\";\r\n  // const MAIN_URI = \"http://localhost:3000\";\r\n  const REDIRECT_URI = MAIN_URI + \"/naverLogin\";\r\n  const CORS_URI = \"https://cors-anywhere.herokuapp.com/\";\r\n\r\n  // 인가코드\r\n  const location = useLocation();\r\n\r\n  const CODE = location.search.split('=')[1];\r\n  const STATE = location.search.split('=')[2];\r\n  \r\n\r\n  // 네이버로 토큰 발급 요청\r\n  const getNaverToken = () => {\r\n    axios\r\n      .post(\r\n        `https://nid.naver.com/oauth2.0/token?grant_type=authorization_code&client_id=${CLIENT_ID}&client_secret=${CLIENT_SECRET}&code=${CODE}&state=${STATE}`,\r\n        {\r\n          headers: {\r\n            \"Content-Type\": \"application/x-www-form-urlencoded;charset=utf-8\",\r\n          },\r\n        },\r\n        {\r\n          responseType: \"json\"\r\n        },\r\n      )\r\n      .then((res) => res.data)\r\n      .then((data) => {\r\n        if (data.access_token) {\r\n          axios\r\n            .post(\r\n              \"https://j7d109.p.ssafy.io/back/users/login\",\r\n              {\r\n                accessToken: data.access_token,\r\n                loginType: \"N\",\r\n              },\r\n              {\r\n                headers: {\r\n                  \"Content-type\": \"application/json\",\r\n                  Accept: \"application/json\",\r\n                },\r\n              },\r\n            )\r\n            .then((res) => {\r\n              console.log(res)\r\n              if (res.data.message === \"회원가입을 먼저 해주세요.\") {\r\n                // 전역 스테이트로 메인에서 화면이 모달이 뜨게 하기\r\n                navigate(\"/signupModal\");\r\n              } else {\r\n                navigate(\"/main\");\r\n              }\r\n            });\r\n        } else {\r\n          navigate(\"/\");\r\n        }\r\n      });\r\n  };\r\n\r\n\r\n\r\n  // 취소시 로직\r\n  let error = new URL(window.location.href).searchParams.get(\"error_description\");\r\n\r\n  useEffect(() => {\r\n    if (!CODE) return;\r\n    getNaverToken();\r\n    if (error === 'Canceled By User') {\r\n      navigate(\"/\");\r\n    };  \r\n  }, []);\r\n\r\n  return <p style={{color:'green'}}>네이버 로그인 중</p>;\r\n};\r\n\r\n\r\nexport default NaverLoginHandler;"],"mappings":";;;AAAA,SAASA,SAAT,QAA0B,OAA1B;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,kBAAzC;AACA,OAAOC,KAAP,MAAkB,OAAlB;;;AAGA,MAAMC,iBAAiB,GAAG,MAAM;EAAA;;EAE9B,MAAMC,QAAQ,GAAGH,WAAW,EAA5B;EACA,MAAMI,SAAS,GAAG,sBAAlB;EACA,MAAMC,aAAa,GAAG,YAAtB;EACA,MAAMC,QAAQ,GAAG,2BAAjB,CAL8B,CAM9B;;EACA,MAAMC,YAAY,GAAGD,QAAQ,GAAG,aAAhC;EACA,MAAME,QAAQ,GAAG,sCAAjB,CAR8B,CAU9B;;EACA,MAAMC,QAAQ,GAAGV,WAAW,EAA5B;EAEA,MAAMW,IAAI,GAAGD,QAAQ,CAACE,MAAT,CAAgBC,KAAhB,CAAsB,GAAtB,EAA2B,CAA3B,CAAb;EACA,MAAMC,KAAK,GAAGJ,QAAQ,CAACE,MAAT,CAAgBC,KAAhB,CAAsB,GAAtB,EAA2B,CAA3B,CAAd,CAd8B,CAiB9B;;EACA,MAAME,aAAa,GAAG,MAAM;IAC1Bb,KAAK,CACFc,IADH,CAEK,gFAA+EX,SAAU,kBAAiBC,aAAc,SAAQK,IAAK,UAASG,KAAM,EAFzJ,EAGI;MACEG,OAAO,EAAE;QACP,gBAAgB;MADT;IADX,CAHJ,EAQI;MACEC,YAAY,EAAE;IADhB,CARJ,EAYGC,IAZH,CAYSC,GAAD,IAASA,GAAG,CAACC,IAZrB,EAaGF,IAbH,CAaSE,IAAD,IAAU;MACd,IAAIA,IAAI,CAACC,YAAT,EAAuB;QACrBpB,KAAK,CACFc,IADH,CAEI,4CAFJ,EAGI;UACEO,WAAW,EAAEF,IAAI,CAACC,YADpB;UAEEE,SAAS,EAAE;QAFb,CAHJ,EAOI;UACEP,OAAO,EAAE;YACP,gBAAgB,kBADT;YAEPQ,MAAM,EAAE;UAFD;QADX,CAPJ,EAcGN,IAdH,CAcSC,GAAD,IAAS;UACbM,OAAO,CAACC,GAAR,CAAYP,GAAZ;;UACA,IAAIA,GAAG,CAACC,IAAJ,CAASO,OAAT,KAAqB,gBAAzB,EAA2C;YACzC;YACAxB,QAAQ,CAAC,cAAD,CAAR;UACD,CAHD,MAGO;YACLA,QAAQ,CAAC,OAAD,CAAR;UACD;QACF,CAtBH;MAuBD,CAxBD,MAwBO;QACLA,QAAQ,CAAC,GAAD,CAAR;MACD;IACF,CAzCH;EA0CD,CA3CD,CAlB8B,CAiE9B;;;EACA,IAAIyB,KAAK,GAAG,IAAIC,GAAJ,CAAQC,MAAM,CAACrB,QAAP,CAAgBsB,IAAxB,EAA8BC,YAA9B,CAA2CC,GAA3C,CAA+C,mBAA/C,CAAZ;EAEAnC,SAAS,CAAC,MAAM;IACd,IAAI,CAACY,IAAL,EAAW;IACXI,aAAa;;IACb,IAAIc,KAAK,KAAK,kBAAd,EAAkC;MAChCzB,QAAQ,CAAC,GAAD,CAAR;IACD;;IAAA;EACF,CANQ,EAMN,EANM,CAAT;EAQA,oBAAO;IAAG,KAAK,EAAE;MAAC+B,KAAK,EAAC;IAAP,CAAV;IAAA;EAAA;IAAA;IAAA;IAAA;EAAA,QAAP;AACD,CA7ED;;GAAMhC,iB;UAEaF,W,EASAD,W;;;KAXbG,iB;AAgFN,eAAeA,iBAAf"},"metadata":{},"sourceType":"module"}